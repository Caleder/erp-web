(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Basic"],{"0a49":function(e,t,r){var a=r("9b43"),n=r("626a"),s=r("4bf8"),o=r("9def"),i=r("cd1c");e.exports=function(e,t){var r=1==e,l=2==e,c=3==e,u=4==e,p=6==e,m=5==e||p,d=t||i;return function(t,i,f){for(var h,b,v=s(t),g=n(v),y=a(i,f,3),w=o(g.length),F=0,x=r?d(t,w):l?d(t,0):void 0;w>F;F++)if((m||F in g)&&(h=g[F],b=y(h,F,v),e))if(r)x[F]=b;else if(b)switch(e){case 3:return!0;case 5:return h;case 6:return F;case 2:x.push(h)}else if(u)return!1;return p?-1:c||u?u:x}}},1169:function(e,t,r){var a=r("2d95");e.exports=Array.isArray||function(e){return"Array"==a(e)}},1563:function(e,t,r){},"1da1":function(e,t,r){"use strict";function a(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(c){return void r(c)}i.done?t(l):Promise.resolve(l).then(a,n)}function n(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function i(e){a(o,n,s,i,l,"next",e)}function l(e){a(o,n,s,i,l,"throw",e)}i(void 0)}))}}r.d(t,"a",(function(){return n}))},"20d6":function(e,t,r){"use strict";var a=r("5ca1"),n=r("0a49")(6),s="findIndex",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),a(a.P+a.F*o,"Array",{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(s)},2954:function(e,t,r){"use strict";var a=r("fd71"),n=r.n(a);n.a},2960:function(e,t,r){},4019:function(e,t,r){"use strict";var a=r("2960"),n=r.n(a);n.a},"4c19":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("供应商管理")])],1),r("el-card",[r("el-row",{staticClass:"query",attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-select",{attrs:{placeholder:"请选择供应商类别",clearable:""},model:{value:e.params.query.categoryId,callback:function(t){e.$set(e.params.query,"categoryId",t)},expression:"params.query.categoryId"}},e._l(e.categoryList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))])])})),1)],1),r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{placeholder:"请输入供应商编号/名称/联系人/电话查询",clearable:""},on:{clear:e.getSupplierPage},model:{value:e.params.query.name,callback:function(t){e.$set(e.params.query,"name",t)},expression:"params.query.name"}})],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"success"},on:{click:e.clear}},[e._v("重置")])],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAddDialog()}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.supplierList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"供应商类别",prop:"categoryName"}}),r("el-table-column",{attrs:{label:"供应商编号",prop:"code"}}),r("el-table-column",{attrs:{label:"供应商名称",prop:"name"}}),r("el-table-column",{attrs:{label:"首要联系人",prop:"contactName"}}),r("el-table-column",{attrs:{label:"手机",prop:"mobile"}}),r("el-table-column",{attrs:{label:"座机",prop:"phone"}}),r("el-table-column",{attrs:{label:"QQ/微信",prop:"qq"}}),r("el-table-column",{attrs:{label:"期初往来余额",prop:"beginBalanceDisplay"}}),r("el-table-column",{attrs:{label:"是否启用",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.supplierStateChanged(t.row)}},model:{value:t.row.active,callback:function(r){e.$set(t.row,"active",r)},expression:"scope.row.active"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteSupplier(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.params.current,"page-sizes":[1,2,5,10],"page-size":e.params.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:e.isAdd?"新增供应商":"修改供应商",visible:e.saveDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveDialogVisible=t},close:e.saveDialogClosed}},[r("el-form",{ref:"saveFormRef",attrs:{model:e.saveForm,rules:e.saveFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"供应商编号",prop:"code"}},[r("el-input",{model:{value:e.saveForm.code,callback:function(t){e.$set(e.saveForm,"code",t)},expression:"saveForm.code"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"供应商名称",prop:"name"}},[r("el-input",{model:{value:e.saveForm.name,callback:function(t){e.$set(e.saveForm,"name",t)},expression:"saveForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"供应商类别",prop:"categoryId"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.saveForm.categoryId,callback:function(t){e.$set(e.saveForm,"categoryId",t)},expression:"saveForm.categoryId"}},e._l(e.categoryList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"增值税税率",prop:"vatRate"}},[r("el-input",{model:{value:e.saveForm.vatRate,callback:function(t){e.$set(e.saveForm,"vatRate",e._n(t))},expression:"saveForm.vatRate"}},[r("template",{slot:"append"},[e._v("%")])],2)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"余额日期",prop:"balanceTime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.saveForm.balanceTime,callback:function(t){e.$set(e.saveForm,"balanceTime",t)},expression:"saveForm.balanceTime"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"期初应付款",prop:"beginReceivableAmountDisplay"}},[r("el-input",{model:{value:e.saveForm.beginReceivableAmountDisplay,callback:function(t){e.$set(e.saveForm,"beginReceivableAmountDisplay",t)},expression:"saveForm.beginReceivableAmountDisplay"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"期初预付款",prop:"beginPrepaidAmountDisplay"}},[r("el-input",{model:{value:e.saveForm.beginPrepaidAmountDisplay,callback:function(t){e.$set(e.saveForm,"beginPrepaidAmountDisplay",t)},expression:"saveForm.beginPrepaidAmountDisplay"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"备注信息",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"添加备注信息"},model:{value:e.saveForm.remark,callback:function(t){e.$set(e.saveForm,"remark",t)},expression:"saveForm.remark"}})],1)],1)],1),r("el-row",[r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showContactAddDialog()}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.saveForm.contactList,border:"",stripe:"",height:"200"}},[r("el-table-column",{attrs:{label:"联系人",prop:"name"}}),r("el-table-column",{attrs:{label:"手机",prop:"mobile"}}),r("el-table-column",{attrs:{label:"座机",prop:"phone"}}),r("el-table-column",{attrs:{label:"QQ/微信",prop:"qq"}}),r("el-table-column",{attrs:{label:"联系地址",prop:"address"}}),r("el-table-column",{attrs:{label:"首要联系人",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.contactPrimaryChanged(t.row)}},model:{value:t.row.primary,callback:function(r){e.$set(t.row,"primary",r)},expression:"scope.row.primary"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showContactEditDialog(t.row,t.$index)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteContact(t.row)}}})],1)]}}])})],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveSupplier}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:e.isContactAdd?"新增联系人":"修改联系人",visible:e.saveContactDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveContactDialogVisible=t},close:e.saveContactDialogClosed}},[r("el-form",{ref:"saveContactFormRef",attrs:{model:e.saveContactForm,rules:e.saveContactFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系人",prop:"name"}},[r("el-input",{model:{value:e.saveContactForm.name,callback:function(t){e.$set(e.saveContactForm,"name",t)},expression:"saveContactForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.saveContactForm.mobile,callback:function(t){e.$set(e.saveContactForm,"mobile",t)},expression:"saveContactForm.mobile"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"座机",prop:"phone"}},[r("el-input",{model:{value:e.saveContactForm.phone,callback:function(t){e.$set(e.saveContactForm,"phone",t)},expression:"saveContactForm.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"QQ/微信",prop:"qq"}},[r("el-input",{model:{value:e.saveContactForm.qq,callback:function(t){e.$set(e.saveContactForm,"qq",t)},expression:"saveContactForm.qq"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系地址",prop:"address"}},[r("el-input",{model:{value:e.saveContactForm.address,callback:function(t){e.$set(e.saveContactForm,"address",t)},expression:"saveContactForm.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"首要联系人",prop:"primary"}},[r("el-switch",{model:{value:e.saveContactForm.primary,callback:function(t){e.$set(e.saveContactForm,"primary",t)},expression:"saveContactForm.primary"}})],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveContactDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveContact}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("20d6"),r("ac6a"),r("96cf"),r("1da1")),o={data:function(){return{params:{query:{},current:1,size:5},total:0,categoryList:[],levelList:[],supplierList:[],isAdd:!0,saveDialogVisible:!1,saveForm:{vatRate:17,contactList:[]},saveFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"blur"}],vatRate:[{required:!0,message:"请设置增值税税率",trigger:"blur"}]},isContactAdd:!0,modifyContactIndex:0,saveContactDialogVisible:!1,saveContactForm:{},saveContactFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},watch:{"saveForm.beginReceivableAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginReceivableAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginReceivableAmount)&&this.$message.error("期初应收款不正确！")):this.saveForm.beginReceivableAmount=0},"saveForm.beginPrepaidAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginPrepaidAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginPrepaidAmount)&&this.$message.error("期初预收款不正确！")):this.saveForm.beginPrepaidAmount=0}},created:function(){this.getCategoryList(),this.getSupplierPage()},methods:{getCategoryList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/category/list",{type:20});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.categoryList=r.data.categoryList;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),search:function(){this.getSupplierPage()},clear:function(){this.params.query={},this.getSupplierPage()},getSupplierPage:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/supplier/page",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.supplierList=r.data.supplierPage.records,this.supplierList.forEach((function(e){e.beginBalanceDisplay=(e.beginBalance/100).toFixed(2)})),this.total=r.data.supplierPage.total;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.params.size=e,this.getSupplierPage()},handleCurrentChange:function(e){this.params.current=e,this.getSupplierPage()},supplierStateChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/supplier/switchActive",{supplierId:t.id});case 2:if(r=e.sent,a=r.data,a.success){e.next=7;break}return t.active=!t.active,e.abrupt("return",this.$message.error("更新供应商状态失败！"));case 7:t.active=a.data.supplier.active,this.$message.success("更新供应商状态成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showAddDialog:function(){this.isAdd=!0,this.saveDialogVisible=!0},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/supplier/detail",{supplierId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:n=a.data.supplier,n.beginReceivableAmountDisplay=(n.beginReceivableAmount/100).toFixed(2),n.beginPrepaidAmountDisplay=(n.beginPrepaidAmount/100).toFixed(2),this.saveForm=n,this.isAdd=!1,this.saveDialogVisible=!0;case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveDialogClosed:function(){this.$refs.saveFormRef.resetFields(),this.saveForm={vatRate:17,contactList:[]}},saveSupplier:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.saveFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/supplier/save",{supplier:t.saveForm,contactList:t.saveForm.contactList});case 4:if(a=e.sent,n=a.data,n.success){e.next=8;break}return e.abrupt("return",t.$message.error(n.message));case 8:t.$message.success("保存供应商成功！"),t.saveDialogVisible=!1,t.getSupplierPage();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteSupplier:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该供应商，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/supplier/delete",{supplierId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除供应商失败！"));case 11:this.$message.success("删除供应商成功！"),this.getSupplierPage();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showContactAddDialog:function(){this.isContactAdd=!0,this.saveContactForm={},this.saveContactDialogVisible=!0},showContactEditDialog:function(e,t){this.isContactAdd=!1,this.saveContactForm=this.$_.cloneDeep(e),this.modifyContactIndex=t,this.saveContactDialogVisible=!0},saveContactDialogClosed:function(){this.isContactAdd&&this.$refs.saveContactFormRef.resetFields()},saveContact:function(){var e=this;this.$refs.saveContactFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:a=e.$_.cloneDeep(e.saveContactForm),null==e.saveForm.contactList||0===e.saveForm.contactList.length?a.primary=!0:a.primary&&e.saveForm.contactList.forEach((function(e){e.primary=!1})),e.isContactAdd?(e.saveForm.contactList.push(a),e.$message.success("添加联系人成功！")):(e.saveForm.contactList.splice(e.modifyContactIndex,1,a),e.$message.success("修改联系人成功！")),e.saveContactDialogVisible=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},contactPrimaryChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.primary&&(this.saveForm.contactList.forEach((function(e){e.primary=!1})),t.primary=!0),this.$message.success("更新主要联系人成功！");case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteContact:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("删除该联系人，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:this.saveForm.contactList.splice(this.saveForm.contactList.findIndex((function(e){return e===t})),1),this.$message.success("删除联系人成功！");case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=(r("4019"),r("2877")),c=Object(l["a"])(i,a,n,!1,null,"58dd1fca",null);t["default"]=c.exports},5254:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("客户管理")])],1),r("el-card",[r("el-row",{staticClass:"query",attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-select",{attrs:{placeholder:"请选择客户类别",clearable:""},model:{value:e.params.query.categoryId,callback:function(t){e.$set(e.params.query,"categoryId",t)},expression:"params.query.categoryId"}},e._l(e.categoryList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))])])})),1)],1),r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{placeholder:"请输入客户编号/名称/联系人/电话查询",clearable:""},on:{clear:e.getCustomerPage},model:{value:e.params.query.name,callback:function(t){e.$set(e.params.query,"name",t)},expression:"params.query.name"}})],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"success"},on:{click:e.clear}},[e._v("重置")])],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAddDialog()}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.customerList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"客户类别",prop:"categoryName"}}),r("el-table-column",{attrs:{label:"客户编号",prop:"code"}}),r("el-table-column",{attrs:{label:"客户名称",prop:"name"}}),r("el-table-column",{attrs:{label:"联系人",prop:"contactName"}}),r("el-table-column",{attrs:{label:"手机",prop:"mobile"}}),r("el-table-column",{attrs:{label:"座机",prop:"phone"}}),r("el-table-column",{attrs:{label:"职位",prop:"position"}}),r("el-table-column",{attrs:{label:"QQ/微信",prop:"qq"}}),r("el-table-column",{attrs:{label:"期初往来余额",prop:"beginBalanceDisplay"}}),r("el-table-column",{attrs:{label:"送货地址",prop:"address"}}),r("el-table-column",{attrs:{label:"是否启用",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.customerStateChanged(t.row)}},model:{value:t.row.active,callback:function(r){e.$set(t.row,"active",r)},expression:"scope.row.active"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteCustomer(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.params.current,"page-sizes":[1,2,5,10],"page-size":e.params.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:e.isAdd?"新增客户":"修改客户",visible:e.saveDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveDialogVisible=t},close:e.saveDialogClosed}},[r("el-form",{ref:"saveFormRef",attrs:{model:e.saveForm,rules:e.saveFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"客户编号",prop:"code"}},[r("el-input",{model:{value:e.saveForm.code,callback:function(t){e.$set(e.saveForm,"code",t)},expression:"saveForm.code"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"客户名称",prop:"name"}},[r("el-input",{model:{value:e.saveForm.name,callback:function(t){e.$set(e.saveForm,"name",t)},expression:"saveForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"客户类别",prop:"categoryId"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.saveForm.categoryId,callback:function(t){e.$set(e.saveForm,"categoryId",t)},expression:"saveForm.categoryId"}},e._l(e.categoryList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"客户等级",prop:"level"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.saveForm.level,callback:function(t){e.$set(e.saveForm,"level",t)},expression:"saveForm.level"}},e._l(e.levelList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"余额日期",prop:"balanceTime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.saveForm.balanceTime,callback:function(t){e.$set(e.saveForm,"balanceTime",t)},expression:"saveForm.balanceTime"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"期初应收款",prop:"beginReceivableAmountDisplay"}},[r("el-input",{model:{value:e.saveForm.beginReceivableAmountDisplay,callback:function(t){e.$set(e.saveForm,"beginReceivableAmountDisplay",t)},expression:"saveForm.beginReceivableAmountDisplay"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"期初预收款",prop:"beginPrepaidAmountDisplay"}},[r("el-input",{model:{value:e.saveForm.beginPrepaidAmountDisplay,callback:function(t){e.$set(e.saveForm,"beginPrepaidAmountDisplay",t)},expression:"saveForm.beginPrepaidAmountDisplay"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"备注信息",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"添加备注信息"},model:{value:e.saveForm.remark,callback:function(t){e.$set(e.saveForm,"remark",t)},expression:"saveForm.remark"}})],1)],1)],1),r("el-row",[r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showContactAddDialog()}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.saveForm.contactList,border:"",stripe:"",height:"200"}},[r("el-table-column",{attrs:{label:"联系人",prop:"name"}}),r("el-table-column",{attrs:{label:"手机",prop:"mobile"}}),r("el-table-column",{attrs:{label:"座机",prop:"phone"}}),r("el-table-column",{attrs:{label:"职位",prop:"position"}}),r("el-table-column",{attrs:{label:"QQ/微信",prop:"qq"}}),r("el-table-column",{attrs:{label:"联系地址",prop:"address"}}),r("el-table-column",{attrs:{label:"首要联系人",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.contactPrimaryChanged(t.row)}},model:{value:t.row.primary,callback:function(r){e.$set(t.row,"primary",r)},expression:"scope.row.primary"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showContactEditDialog(t.row,t.$index)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteContact(t.row)}}})],1)]}}])})],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveCustomer}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:e.isContactAdd?"新增联系人":"修改联系人",visible:e.saveContactDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveContactDialogVisible=t},close:e.saveContactDialogClosed}},[r("el-form",{ref:"saveContactFormRef",attrs:{model:e.saveContactForm,rules:e.saveContactFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系人",prop:"name"}},[r("el-input",{model:{value:e.saveContactForm.name,callback:function(t){e.$set(e.saveContactForm,"name",t)},expression:"saveContactForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.saveContactForm.mobile,callback:function(t){e.$set(e.saveContactForm,"mobile",t)},expression:"saveContactForm.mobile"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"座机",prop:"phone"}},[r("el-input",{model:{value:e.saveContactForm.phone,callback:function(t){e.$set(e.saveContactForm,"phone",t)},expression:"saveContactForm.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"职位",prop:"position"}},[r("el-input",{model:{value:e.saveContactForm.position,callback:function(t){e.$set(e.saveContactForm,"position",t)},expression:"saveContactForm.position"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"QQ/微信",prop:"qq"}},[r("el-input",{model:{value:e.saveContactForm.qq,callback:function(t){e.$set(e.saveContactForm,"qq",t)},expression:"saveContactForm.qq"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系地址",prop:"address"}},[r("el-input",{model:{value:e.saveContactForm.address,callback:function(t){e.$set(e.saveContactForm,"address",t)},expression:"saveContactForm.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"首要联系人",prop:"primary"}},[r("el-switch",{model:{value:e.saveContactForm.primary,callback:function(t){e.$set(e.saveContactForm,"primary",t)},expression:"saveContactForm.primary"}})],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveContactDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveContact}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("20d6"),r("ac6a"),r("96cf"),r("1da1")),o={data:function(){return{params:{query:{},current:1,size:5},total:0,categoryList:[],levelList:[],customerList:[],isAdd:!0,saveDialogVisible:!1,saveForm:{contactList:[]},saveFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"blur"}],level:[{required:!0,message:"请选择客户等级",trigger:"blur"}]},isContactAdd:!0,modifyContactIndex:0,saveContactDialogVisible:!1,saveContactForm:{},saveContactFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},watch:{"saveForm.beginReceivableAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginReceivableAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginReceivableAmount)&&this.$message.error("期初应收款不正确！")):this.saveForm.beginReceivableAmount=0},"saveForm.beginPrepaidAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginPrepaidAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginPrepaidAmount)&&this.$message.error("期初预收款不正确！")):this.saveForm.beginPrepaidAmount=0}},created:function(){this.getCategoryList(),this.getLevelList(),this.getCustomerPage()},methods:{getCategoryList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/category/list",{type:10});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.categoryList=r.data.categoryList;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getLevelList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/dict/itemList",{dictCode:"customer_level"});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.levelList=r.data.itemList;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),search:function(){this.getCustomerPage()},clear:function(){this.params.query={},this.getCustomerPage()},getCustomerPage:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/customer/page",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.customerList=r.data.customerPage.records,this.customerList.forEach((function(e){e.beginBalanceDisplay=(e.beginBalance/100).toFixed(2)})),this.total=r.data.customerPage.total;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.params.size=e,this.getCustomerPage()},handleCurrentChange:function(e){this.params.current=e,this.getCustomerPage()},customerStateChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/customer/switchActive",{customerId:t.id});case 2:if(r=e.sent,a=r.data,a.success){e.next=7;break}return t.active=!t.active,e.abrupt("return",this.$message.error("更新客户状态失败！"));case 7:t.active=a.data.customer.active,this.$message.success("更新客户状态成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showAddDialog:function(){this.isAdd=!0,this.saveDialogVisible=!0},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/customer/detail",{customerId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:n=a.data.customer,n.beginReceivableAmountDisplay=(n.beginReceivableAmount/100).toFixed(2),n.beginPrepaidAmountDisplay=(n.beginPrepaidAmount/100).toFixed(2),this.saveForm=n,this.isAdd=!1,this.saveDialogVisible=!0;case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveDialogClosed:function(){this.$refs.saveFormRef.resetFields(),this.saveForm={contactList:[]}},saveCustomer:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.saveFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/customer/save",{customer:t.saveForm,contactList:t.saveForm.contactList});case 4:if(a=e.sent,n=a.data,n.success){e.next=8;break}return e.abrupt("return",t.$message.error(n.message));case 8:t.$message.success("保存客户成功！"),t.saveDialogVisible=!1,t.getCustomerPage();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteCustomer:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该客户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/customer/delete",{customerId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除客户失败！"));case 11:this.$message.success("删除客户成功！"),this.getCustomerPage();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showContactAddDialog:function(){this.isContactAdd=!0,this.saveContactForm={},this.saveContactDialogVisible=!0},showContactEditDialog:function(e,t){this.isContactAdd=!1,this.saveContactForm=this.$_.cloneDeep(e),this.modifyContactIndex=t,this.saveContactDialogVisible=!0},saveContactDialogClosed:function(){this.isContactAdd&&this.$refs.saveContactFormRef.resetFields()},saveContact:function(){var e=this;this.$refs.saveContactFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:a=e.$_.cloneDeep(e.saveContactForm),null==e.saveForm.contactList||0===e.saveForm.contactList.length?a.primary=!0:a.primary&&e.saveForm.contactList.forEach((function(e){e.primary=!1})),e.isContactAdd?(e.saveForm.contactList.push(a),e.$message.success("添加联系人成功！")):(e.saveForm.contactList.splice(e.modifyContactIndex,1,a),e.$message.success("修改联系人成功！")),e.saveContactDialogVisible=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},contactPrimaryChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.primary&&(this.saveForm.contactList.forEach((function(e){e.primary=!1})),t.primary=!0),this.$message.success("更新客户状态成功！");case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteContact:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("删除该联系人，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:this.saveForm.contactList.splice(this.saveForm.contactList.findIndex((function(e){return e===t})),1),this.$message.success("删除联系人成功！");case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=(r("2954"),r("2877")),c=Object(l["a"])(i,a,n,!1,null,"54e1147b",null);t["default"]=c.exports},"7f7f":function(e,t,r){var a=r("86cc").f,n=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in n||r("9e1e")&&a(n,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(e){return""}}})},"96cf":function(e,t){!function(t){"use strict";var r,a=Object.prototype,n=a.hasOwnProperty,s="function"===typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",i=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag",c="object"===typeof e,u=t.regeneratorRuntime;if(u)c&&(e.exports=u);else{u=t.regeneratorRuntime=c?e.exports:{},u.wrap=w;var p="suspendedStart",m="suspendedYield",d="executing",f="completed",h={},b={};b[o]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(q([])));g&&g!==a&&n.call(g,o)&&(b=g);var y=C.prototype=x.prototype=Object.create(b);k.prototype=y.constructor=C,C.constructor=k,C[l]=k.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(y),e},u.awrap=function(e){return{__await:e}},$(R.prototype),R.prototype[i]=function(){return this},u.AsyncIterator=R,u.async=function(e,t,r,a){var n=new R(w(e,t,r,a));return u.isGeneratorFunction(t)?n:n.next().then((function(e){return e.done?e.value:n.next()}))},$(y),y[l]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){while(t.length){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},u.values=q,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=r),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;A(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:q(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=r),h}}}function w(e,t,r,a){var n=t&&t.prototype instanceof x?t:x,s=Object.create(n.prototype),o=new _(a||[]);return s._invoke=D(e,r,o),s}function F(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(a){return{type:"throw",arg:a}}}function x(){}function k(){}function C(){}function $(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function R(e){function t(r,a,s,o){var i=F(e[r],e,a);if("throw"!==i.type){var l=i.arg,c=l.value;return c&&"object"===typeof c&&n.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,s,o)}),(function(e){t("throw",e,s,o)})):Promise.resolve(c).then((function(e){l.value=e,s(l)}),o)}o(i.arg)}var r;function a(e,a){function n(){return new Promise((function(r,n){t(e,a,r,n)}))}return r=r?r.then(n,n):n()}this._invoke=a}function D(e,t,r){var a=p;return function(n,s){if(a===d)throw new Error("Generator is already running");if(a===f){if("throw"===n)throw s;return S()}r.method=n,r.arg=s;while(1){var o=r.delegate;if(o){var i=L(o,r);if(i){if(i===h)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=d;var l=F(e,t,r);if("normal"===l.type){if(a=r.done?f:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=f,r.method="throw",r.arg=l.arg)}}}function L(e,t){var a=e.iterator[t.method];if(a===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,L(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=F(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var s=n.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,h):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function q(e){if(e){var t=e[o];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function t(){while(++a<e.length)if(n.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=r,t.done=!0,t};return s.next=s}}return{next:S}}function S(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())},a599:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("仓库管理")])],1),r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.warehouseList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"仓库编号",prop:"code"}}),r("el-table-column",{attrs:{label:"仓库名称",prop:"name"}}),r("el-table-column",{attrs:{label:"是否启用",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.warehouseStateChanged(t.row)}},model:{value:t.row.active,callback:function(r){e.$set(t.row,"active",r)},expression:"scope.row.active"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteWarehouse(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.params.current,"page-sizes":[1,2,5,10],"page-size":e.params.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加仓库",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"仓库编号",prop:"code"}},[r("el-input",{model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1),r("el-form-item",{attrs:{label:"仓库名称",prop:"name"}},[r("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addWarehouse}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改仓库",visible:e.editDialogVisible,width:"30%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"仓库编号",prop:"code"}},[r("el-input",{model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),r("el-form-item",{attrs:{label:"仓库名称",prop:"name"}},[r("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editWarehouse}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("96cf"),r("1da1")),o={data:function(){return{params:{query:{},current:1,size:5},total:0,warehouseList:[],addDialogVisible:!1,addForm:{},addFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},editDialogVisible:!1,editForm:{},editFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},created:function(){this.getWarehousePage()},methods:{getWarehousePage:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/warehouse/page",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.warehouseList=r.data.warehousePage.records,this.total=r.data.warehousePage.total;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.params.size=e,this.getWarehousePage()},handleCurrentChange:function(e){this.params.current=e,this.getWarehousePage()},warehouseStateChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/warehouse/switchActive",{warehouseId:t.id});case 2:if(r=e.sent,a=r.data,a.success){e.next=7;break}return t.active=!t.active,e.abrupt("return",this.$message.error("更新仓库状态失败！"));case 7:t.active=a.data.warehouse.active,this.$message.success("更新仓库状态成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addWarehouse:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.post("/warehouse/save",{warehouse:e.addForm});case 4:if(a=t.sent,n=a.data,n.success){t.next=8;break}return t.abrupt("return",e.$message.error(n.message));case 8:e.$message.success("添加仓库成功！"),e.addDialogVisible=!1,e.getWarehousePage();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/warehouse/detail",{warehouseId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:this.editForm=a.data.warehouse,this.editDialogVisible=!0;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editWarehouse:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.editFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/warehouse/save",{warehouse:t.editForm});case 4:if(a=e.sent,n=a.data,n.success){e.next=8;break}return e.abrupt("return",t.$message.error(n.message));case 8:t.editDialogVisible=!1,t.getWarehousePage(),t.$message.success("修改仓库信息成功！");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteWarehouse:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该仓库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/warehouse/delete",{warehouseId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除仓库失败！"));case 11:this.$message.success("删除仓库成功！"),this.getWarehousePage();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=r("2877"),c=Object(l["a"])(i,a,n,!1,null,"5a27ffe6",null);t["default"]=c.exports},ab3b:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("账户管理")])],1),r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.accountList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"账户编号",prop:"code"}}),r("el-table-column",{attrs:{label:"账户名称",prop:"name"}}),r("el-table-column",{attrs:{label:"当前余额",prop:"currentBalance"}}),r("el-table-column",{attrs:{label:"期初余额",prop:"beginBalance"}}),r("el-table-column",{attrs:{label:"建账日期",prop:"balanceTime",formatter:e.dateFormatter}}),r("el-table-column",{attrs:{label:"账户类别",prop:"typeName"}}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteAccount(t.row.id)}}})],1)]}}])})],1)],1),r("el-dialog",{attrs:{title:"添加账户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"90px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户编号",prop:"code"}},[r("el-input",{model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户名称",prop:"name"}},[r("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"余额日期",prop:"balanceTime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.addForm.balanceTime,callback:function(t){e.$set(e.addForm,"balanceTime",t)},expression:"addForm.balanceTime"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户余额",prop:"beginBalance"}},[r("el-input",{model:{value:e.addForm.beginBalance,callback:function(t){e.$set(e.addForm,"beginBalance",t)},expression:"addForm.beginBalance"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addAccount}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改账户",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"90px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户编号",prop:"code"}},[r("el-input",{model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户名称",prop:"name"}},[r("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"余额日期",prop:"balanceTime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.editForm.balanceTime,callback:function(t){e.$set(e.editForm,"balanceTime",t)},expression:"editForm.balanceTime"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户余额",prop:"beginBalance"}},[r("el-input",{model:{value:e.editForm.beginBalance,callback:function(t){e.$set(e.editForm,"beginBalance",t)},expression:"editForm.beginBalance"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editAccount}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("7f7f"),r("ac6a"),r("96cf"),r("1da1")),o={data:function(){return{params:{query:{}},typeList:[],accountList:[],addDialogVisible:!1,addForm:{beginBalance:0,balanceTime:new Date},addFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]},editDialogVisible:!1,editForm:{},editFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]}}},created:function(){this.getTypeList(),this.getAccountList()},methods:{getTypeList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/dict/itemList",{dictCode:"account_type"});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.typeList=r.data.itemList;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAccountList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/settlementAccount/list",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.accountList=r.data.accountList,this.accountList.forEach((function(e){e.currentBalance=(e.currentBalance/100).toFixed(2),e.beginBalance=(e.beginBalance/100).toFixed(2)}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),dateFormatter:function(e,t){var r=e[t.property];return void 0===r?"":this.$moment(r).format("YYYY-MM-DD")},addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addAccount:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:if(a=parseInt(100*parseFloat(e.addForm.beginBalance)),!isNaN(a)){t.next=6;break}return e.$message.error("账户余额不正确！"),t.abrupt("return");case 6:return t.next=8,e.$http.post("/settlementAccount/save",{account:{code:e.addForm.code,name:e.addForm.name,balanceTime:e.addForm.balanceTime,type:e.addForm.type,beginBalance:a}});case 8:if(n=t.sent,s=n.data,s.success){t.next=12;break}return t.abrupt("return",e.$message.error(s.message));case 12:e.$message.success("添加账户成功！"),e.addDialogVisible=!1,e.getAccountList();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/settlementAccount/detail",{accountId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:this.editForm=a.data.account,this.editForm.beginBalance=(this.editForm.beginBalance/100).toFixed(2),this.editDialogVisible=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editAccount:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.editFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(a=parseInt(100*parseFloat(t.editForm.beginBalance)),!isNaN(a)){e.next=6;break}return t.$message.error("账户余额不正确！"),e.abrupt("return");case 6:return e.next=8,t.$http.post("/settlementAccount/save",{account:{id:t.editForm.id,code:t.editForm.code,name:t.editForm.name,balanceTime:t.editForm.balanceTime,type:t.editForm.type,beginBalance:a}});case 8:if(n=e.sent,s=n.data,s.success){e.next=12;break}return e.abrupt("return",t.$message.error(s.message));case 12:t.editDialogVisible=!1,t.getAccountList(),t.$message.success("修改账户信息成功！");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteAccount:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该账户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/settlementAccount/delete",{accountId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除账户失败！"));case 11:this.$message.success("删除账户成功！"),this.getAccountList();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=(r("c01c"),r("2877")),c=Object(l["a"])(i,a,n,!1,null,"235307c6",null);t["default"]=c.exports},ac6a:function(e,t,r){for(var a=r("cadf"),n=r("0d58"),s=r("2aba"),o=r("7726"),i=r("32e9"),l=r("84f2"),c=r("2b4c"),u=c("iterator"),p=c("toStringTag"),m=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=n(d),h=0;h<f.length;h++){var b,v=f[h],g=d[v],y=o[v],w=y&&y.prototype;if(w&&(w[u]||i(w,u,m),w[p]||i(w,p,v),l[v]=m,g))for(b in a)w[b]||s(w,b,a[b],!0)}},c01c:function(e,t,r){"use strict";var a=r("e406"),n=r.n(a);n.a},c2f9:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("职员管理")])],1),r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.employeeList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"职员编号",prop:"code"}}),r("el-table-column",{attrs:{label:"职员名称",prop:"name"}}),r("el-table-column",{attrs:{label:"是否启用",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.employeeStateChanged(t.row)}},model:{value:t.row.active,callback:function(r){e.$set(t.row,"active",r)},expression:"scope.row.active"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteEmployee(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.params.current,"page-sizes":[1,2,5,10],"page-size":e.params.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加职员",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"职员编号",prop:"code"}},[r("el-input",{model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1),r("el-form-item",{attrs:{label:"职员名称",prop:"name"}},[r("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addEmployee}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改职员",visible:e.editDialogVisible,width:"30%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"职员编号",prop:"code"}},[r("el-input",{model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),r("el-form-item",{attrs:{label:"职员名称",prop:"name"}},[r("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editEmployee}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("96cf"),r("1da1")),o={data:function(){return{params:{query:{},current:1,size:5},total:0,employeeList:[],addDialogVisible:!1,addForm:{},addFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},editDialogVisible:!1,editForm:{},editFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},created:function(){this.getEmployeePage()},methods:{getEmployeePage:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/employee/page",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.employeeList=r.data.employeePage.records,this.total=r.data.employeePage.total;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.params.size=e,this.getEmployeePage()},handleCurrentChange:function(e){this.params.current=e,this.getEmployeePage()},employeeStateChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/employee/switchActive",{employeeId:t.id});case 2:if(r=e.sent,a=r.data,a.success){e.next=7;break}return t.active=!t.active,e.abrupt("return",this.$message.error("更新职员状态失败！"));case 7:t.active=a.data.employee.active,this.$message.success("更新职员状态成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addEmployee:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.post("/employee/save",{employee:e.addForm});case 4:if(a=t.sent,n=a.data,n.success){t.next=8;break}return t.abrupt("return",e.$message.error(n.message));case 8:e.$message.success("添加职员成功！"),e.addDialogVisible=!1,e.getEmployeePage();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/employee/detail",{employeeId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:this.editForm=a.data.employee,this.editDialogVisible=!0;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editEmployee:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.editFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/employee/save",{employee:t.editForm});case 4:if(a=e.sent,n=a.data,n.success){e.next=8;break}return e.abrupt("return",t.$message.error(n.message));case 8:t.editDialogVisible=!1,t.getEmployeePage(),t.$message.success("修改职员信息成功！");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteEmployee:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该职员 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/employee/delete",{employeeId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除职员失败！"));case 11:this.$message.success("删除职员成功！"),this.getEmployeePage();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=r("2877"),c=Object(l["a"])(i,a,n,!1,null,"a904fd58",null);t["default"]=c.exports},cd1c:function(e,t,r){var a=r("e853");e.exports=function(e,t){return new(a(e))(t)}},e406:function(e,t,r){},e853:function(e,t,r){var a=r("d3f4"),n=r("1169"),s=r("2b4c")("species");e.exports=function(e){var t;return n(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!n(t.prototype)||(t=void 0),a(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?Array:t}},e92c:function(e,t,r){"use strict";var a=r("1563"),n=r.n(a);n.a},f061:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("基础管理")]),r("el-breadcrumb-item",[e._v("商品管理")])],1),r("el-container",[r("el-aside",{attrs:{width:"200px"}},[r("el-card",[r("el-tree",{ref:"tree",attrs:{data:e.categoryList,props:e.defaultProps,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1},on:{"node-click":e.handleNodeClick}})],1)],1),r("el-main",[r("el-card",[r("el-row",{staticClass:"query",attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{placeholder:"请输入商品编号/名称/规格型号查询",clearable:""},on:{clear:e.getProductPage},model:{value:e.params.query.name,callback:function(t){e.$set(e.params.query,"name",t)},expression:"params.query.name"}})],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"success"},on:{click:e.clear}},[e._v("重置")])],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAddDialog()}}},[e._v("新增")])],1)],1),r("el-table",{attrs:{data:e.productList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"商品类别",prop:"categoryName"}}),r("el-table-column",{attrs:{label:"商品编号",prop:"code"}}),r("el-table-column",{attrs:{label:"商品名称",prop:"name"}}),r("el-table-column",{attrs:{label:"规格型号",prop:"spec"}}),r("el-table-column",{attrs:{label:"单位",prop:"unitName"}}),r("el-table-column",{attrs:{label:"当前库存",prop:"stock"}}),r("el-table-column",{attrs:{label:"期初数量",prop:"beginQuantity"}}),r("el-table-column",{attrs:{label:"单位成本",prop:"unitCost"}}),r("el-table-column",{attrs:{label:"期初总价",prop:"beginTotalAmount"}}),r("el-table-column",{attrs:{label:"预计采购价",prop:"estimatedPurchasePrice"}}),r("el-table-column",{attrs:{label:"零售价",prop:"retailPrice"}}),r("el-table-column",{attrs:{label:"备注",prop:"remark"}}),r("el-table-column",{attrs:{label:"是否启用",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.productStateChanged(t.row)}},model:{value:t.row.active,callback:function(r){e.$set(t.row,"active",r)},expression:"scope.row.active"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteProduct(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.params.current,"page-sizes":[1,2,5,10],"page-size":e.params.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1),r("el-dialog",{attrs:{title:e.isAdd?"新增商品":"修改商品",visible:e.saveDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveDialogVisible=t},close:e.saveDialogClosed}},[r("el-form",{ref:"saveFormRef",attrs:{model:e.saveForm,rules:e.saveFormRules,"label-width":"100px"}},[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"基础资料"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商品编号",prop:"code"}},[r("el-input",{model:{value:e.saveForm.code,callback:function(t){e.$set(e.saveForm,"code",t)},expression:"saveForm.code"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{model:{value:e.saveForm.name,callback:function(t){e.$set(e.saveForm,"name",t)},expression:"saveForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商品条码",prop:"barcode"}},[r("el-input",{model:{value:e.saveForm.barcode,callback:function(t){e.$set(e.saveForm,"barcode",t)},expression:"saveForm.barcode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"规格型号",prop:"spec"}},[r("el-input",{model:{value:e.saveForm.spec,callback:function(t){e.$set(e.saveForm,"spec",t)},expression:"saveForm.spec"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商品类别",prop:"categoryId"}},[r("el-select",{ref:"selectCategory",attrs:{value:e.saveForm.categoryName,placeholder:"请选择",clearable:""},on:{clear:e.handleCategorySelectClear}},[r("el-option",{staticStyle:{width:"100%",height:"200px",overflow:"auto","background-color":"#fff"},attrs:{label:e.saveForm.categoryName,value:e.saveForm.categoryId}},[r("el-tree",{attrs:{data:e.categoryList[0].childList,props:e.defaultProps,"expand-on-click-node":!1},on:{"node-click":e.handleCategoryNodeClick}})],1)],1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"首选仓库",prop:"primaryWarehouseId"}},[r("el-select",{attrs:{placeholder:"(空)",clearable:""},model:{value:e.saveForm.primaryWarehouseId,callback:function(t){e.$set(e.saveForm,"primaryWarehouseId",t)},expression:"saveForm.primaryWarehouseId"}},e._l(e.warehouseList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"计量单位",prop:"unitId"}},[r("el-select",{attrs:{placeholder:"(空)",clearable:""},model:{value:e.saveForm.unitId,callback:function(t){e.$set(e.saveForm,"unitId",t)},expression:"saveForm.unitId"}},e._l(e.unitList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-divider",{attrs:{"content-position":"left"}},[e._v("价格策略")]),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"零售价",prop:"retailPrice"}},[r("el-input",{model:{value:e.saveForm.retailPrice,callback:function(t){e.$set(e.saveForm,"retailPrice",t)},expression:"saveForm.retailPrice"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"批发价",prop:"wholesalePrice"}},[r("el-input",{model:{value:e.saveForm.wholesalePrice,callback:function(t){e.$set(e.saveForm,"wholesalePrice",t)},expression:"saveForm.wholesalePrice"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"VIP会员价",prop:"vipPrice"}},[r("el-input",{model:{value:e.saveForm.vipPrice,callback:function(t){e.$set(e.saveForm,"vipPrice",t)},expression:"saveForm.vipPrice"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"折扣率一",prop:"discountRate1"}},[r("el-input",{model:{value:e.saveForm.discountRate1,callback:function(t){e.$set(e.saveForm,"discountRate1",t)},expression:"saveForm.discountRate1"}},[r("template",{slot:"append"},[e._v("%")])],2)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"折扣率二",prop:"discountRate2"}},[r("el-input",{model:{value:e.saveForm.discountRate2,callback:function(t){e.$set(e.saveForm,"discountRate2",t)},expression:"saveForm.discountRate2"}},[r("template",{slot:"append"},[e._v("%")])],2)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"预计采购价",prop:"estimatedPurchasePrice"}},[r("el-input",{model:{value:e.saveForm.estimatedPurchasePrice,callback:function(t){e.$set(e.saveForm,"estimatedPurchasePrice",t)},expression:"saveForm.estimatedPurchasePrice"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"备注信息",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"添加备注信息"},model:{value:e.saveForm.remark,callback:function(t){e.$set(e.saveForm,"remark",t)},expression:"saveForm.remark"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"库存预警"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"最低库存",prop:"minimumStock"}},[r("el-input",{model:{value:e.saveForm.minimumStock,callback:function(t){e.$set(e.saveForm,"minimumStock",t)},expression:"saveForm.minimumStock"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"最高库存",prop:"maximumStock"}},[r("el-input",{model:{value:e.saveForm.maximumStock,callback:function(t){e.$set(e.saveForm,"maximumStock",t)},expression:"saveForm.maximumStock"}})],1)],1)],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveProduct}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:e.isContactAdd?"新增联系人":"修改联系人",visible:e.saveContactDialogVisible,width:"70%"},on:{"update:visible":function(t){e.saveContactDialogVisible=t},close:e.saveContactDialogClosed}},[r("el-form",{ref:"saveContactFormRef",attrs:{model:e.saveContactForm,rules:e.saveContactFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系人",prop:"name"}},[r("el-input",{model:{value:e.saveContactForm.name,callback:function(t){e.$set(e.saveContactForm,"name",t)},expression:"saveContactForm.name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.saveContactForm.mobile,callback:function(t){e.$set(e.saveContactForm,"mobile",t)},expression:"saveContactForm.mobile"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"座机",prop:"phone"}},[r("el-input",{model:{value:e.saveContactForm.phone,callback:function(t){e.$set(e.saveContactForm,"phone",t)},expression:"saveContactForm.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"QQ/微信",prop:"qq"}},[r("el-input",{model:{value:e.saveContactForm.qq,callback:function(t){e.$set(e.saveContactForm,"qq",t)},expression:"saveContactForm.qq"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系地址",prop:"address"}},[r("el-input",{model:{value:e.saveContactForm.address,callback:function(t){e.$set(e.saveContactForm,"address",t)},expression:"saveContactForm.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"首要联系人",prop:"primary"}},[r("el-switch",{model:{value:e.saveContactForm.primary,callback:function(t){e.$set(e.saveContactForm,"primary",t)},expression:"saveContactForm.primary"}})],1)],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.saveContactDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveContact}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("20d6"),r("ac6a"),r("7f7f"),r("96cf"),r("1da1")),o={data:function(){return{defaultProps:{children:"childList",id:"id",label:"name"},params:{query:{categoryId:""},current:1,size:5},total:0,categoryList:[{id:"",name:"全部"}],warehouseList:[],unitList:[],levelList:[],productList:[],isAdd:!0,saveDialogVisible:!1,saveForm:{categoryId:null,vatRate:17,contactList:[]},saveFormRules:{code:[{required:!0,message:"请输入编码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},isContactAdd:!0,modifyContactIndex:0,saveContactDialogVisible:!1,saveContactForm:{},saveContactFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},watch:{"saveForm.beginReceivableAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginReceivableAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginReceivableAmount)&&this.$message.error("期初应收款不正确！")):this.saveForm.beginReceivableAmount=0},"saveForm.beginPrepaidAmountDisplay":function(e,t){void 0!==e&&null!==e&&""!==e?(this.saveForm.beginPrepaidAmount=parseInt(100*parseFloat(e)),isNaN(this.saveForm.beginPrepaidAmount)&&this.$message.error("期初预收款不正确！")):this.saveForm.beginPrepaidAmount=0}},created:function(){this.getCategoryList(),this.getWarehouseList(),this.getUnitList(),this.getProductPage()},methods:{handleNodeClick:function(e){this.params.query.categoryId=e.id,this.getProductPage()},getCategoryList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/category/list",{type:30});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.categoryList=[{id:"",name:"全部",childList:r.data.categoryList}];case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getWarehouseList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/warehouse/page",{current:1,size:1e4});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.warehouseList=r.data.warehousePage.records;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getUnitList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/dict/itemList",{dictCode:"unit"});case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.unitList=r.data.itemList;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),search:function(){this.getProductPage()},clear:function(){this.params.query={},this.$refs.tree.setCurrentNode({id:""}),this.getProductPage()},getProductPage:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/product/page",this.params);case 2:if(t=e.sent,r=t.data,r.success){e.next=6;break}return e.abrupt("return",this.$message.error(r.message));case 6:this.productList=r.data.productPage.records,this.total=r.data.productPage.total;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.params.size=e,this.getProductPage()},handleCurrentChange:function(e){this.params.current=e,this.getProductPage()},productStateChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/product/switchActive",{productId:t.id});case 2:if(r=e.sent,a=r.data,a.success){e.next=7;break}return t.active=!t.active,e.abrupt("return",this.$message.error("更新商品状态失败！"));case 7:t.active=a.data.product.active,this.$message.success("更新商品状态成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCategoryNodeClick:function(e){this.saveForm.categoryId=e.id,this.saveForm.categoryName=e.name,this.$refs.selectCategory.blur()},handleCategorySelectClear:function(){this.saveForm.categoryId=null,this.saveForm.categoryName=""},showAddDialog:function(){this.isAdd=!0,this.saveDialogVisible=!0},showEditDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("/product/detail",{productId:t});case 2:if(r=e.sent,a=r.data,a.success){e.next=6;break}return e.abrupt("return",this.$message.error(a.message));case 6:this.saveForm=a.data.product,this.isAdd=!1,this.saveDialogVisible=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveDialogClosed:function(){this.$refs.saveFormRef.resetFields(),this.saveForm={categoryId:null,vatRate:17,contactList:[]}},saveProduct:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.saveFormRef.validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/product/save",{product:t.saveForm});case 4:if(a=e.sent,n=a.data,n.success){e.next=8;break}return e.abrupt("return",t.$message.error(n.message));case 8:t.$message.success("保存商品成功！"),t.saveDialogVisible=!1,t.getProductPage();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteProduct:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该商品，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:return e.next=7,this.$http.post("/product/delete",{productId:t});case 7:if(a=e.sent,n=a.data,n.success){e.next=11;break}return e.abrupt("return",this.$message.error("删除商品失败！"));case 11:this.$message.success("删除商品成功！"),this.getProductPage();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showContactAddDialog:function(){this.isContactAdd=!0,this.saveContactForm={},this.saveContactDialogVisible=!0},showContactEditDialog:function(e,t){this.isContactAdd=!1,this.saveContactForm=this.$_.cloneDeep(e),this.modifyContactIndex=t,this.saveContactDialogVisible=!0},saveContactDialogClosed:function(){this.isContactAdd&&this.$refs.saveContactFormRef.resetFields()},saveContact:function(){var e=this;this.$refs.saveContactFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:a=e.$_.cloneDeep(e.saveContactForm),null==e.saveForm.contactList||0===e.saveForm.contactList.length?a.primary=!0:a.primary&&e.saveForm.contactList.forEach((function(e){e.primary=!1})),e.isContactAdd?(e.saveForm.contactList.push(a),e.$message.success("添加联系人成功！")):(e.saveForm.contactList.splice(e.modifyContactIndex,1,a),e.$message.success("修改联系人成功！")),e.saveContactDialogVisible=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},contactPrimaryChanged:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.primary&&(this.saveForm.contactList.forEach((function(e){e.primary=!1})),t.primary=!0),this.$message.success("更新主要联系人成功！");case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteContact:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("删除该联系人，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("已取消删除"));case 5:this.saveForm.contactList.splice(this.saveForm.contactList.findIndex((function(e){return e===t})),1),this.$message.success("删除联系人成功！");case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},i=o,l=(r("e92c"),r("2877")),c=Object(l["a"])(i,a,n,!1,null,"8bad50fc",null);t["default"]=c.exports},fd71:function(e,t,r){}}]);
//# sourceMappingURL=Basic.1bddce4d.js.map